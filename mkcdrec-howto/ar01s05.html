<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>5. Cloning with clone-dsk.sh</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="mkCDrec Howto"><link rel="up" href="index.html" title="mkCDrec Howto"><link rel="prev" href="ar01s04.html" title="4. Restoring with start-restore.sh"><link rel="next" href="ar01s06.html" title="6. Restoring a single file system with restore-fs.sh"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5. Cloning with clone-dsk.sh</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s04.html">Terug</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ar01s06.html">Volgende</a></td></tr></table><hr></div><div class="sect1" lang="nl-NL"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e636"></a>5. Cloning with clone-dsk.sh</h2></div></div></div><p>If the archives are not on a CD-ROM make sure the tape is inserted, or the file system has been mounted where original backups were stored on.</p><p>To clone one disk go into the <code class="filename">/etc/recovery</code> directory and type <code class="filename">./clone-sk.sh</code></p><p></p><p><img src="resources/clone1.jpg" width="602"></p><p></p><p>Just follow the questions and select what you want:</p><p></p><p><img src="resources/clone2.jpg" width="390"></p><p></p><p><img src="resources/clone3.jpg" width="390"></p><p></p><p><img src="resources/clone4.jpg" width="531"></p><p></p><p><img src="resources/clone5.jpg" width="478"></p><p></p><p><img src="resources/clone6.jpg" width="496"></p><p></p><p><img src="resources/clone7.jpg" width="567"></p><p></p><p><img src="resources/clone8.jpg" width="461"></p><p></p><p><img src="resources/clone9.jpg" width="602"></p><p></p><p><img src="resources/clone10.jpg" width="496"></p><p></p><p>That&#8217;s about it for cloning a disk.</p><p>Or maybe not!</p><p></p><p>Before rebooting always double check the <code class="filename">/mnt/local/etc/lilo.conf</code> file, or <code class="filename">/mnt/local/boot/grub.conf</code> file whether the boot and root device are correct. Need to change it? Use the &#8220;<span class="emphasis"><em>chroot /mnt/local</em></span>&#8221; command to put the restored disks into root mode for the system.</p><p></p><p>Another issue that may strike you is when you clone to another PC which is 100% the same then it is perhaps necessary to edit the <code class="filename">/mnt/local/etc/modules.conf </code>file and change e.g. the scsi_hostadapter, eth0, and so on.</p><p></p><p>Also, a bit more tricky is when the initial ramdisk needs to be changed. Why do you need the initial ramdisk you might wonder? Well if the new PC has another SCSI card for example then the original one!</p><p>Think wisely before start using mkCDrec on the source PC and add the SCSI modules you might need on the target PC to the <code class="filename">Config.sh</code> file!</p><p>To create a new initial ramdisk do the following:</p><p><span class="emphasis"><em># cd /</em></span></p><p><span class="emphasis"><em># df</em></span></p><p></p><p>Make sure that <code class="filename">/mnt/local </code>(and <code class="filename">/mnt/local/boot</code>) are mounted. Also before doing a chroot mount also the <code class="filename">/usr</code> if needed.</p><p></p><p><span class="emphasis"><em># chroot /mnt/local</em></span></p><p><span class="emphasis"><em># cd /boot</em></span></p><p><span class="emphasis"><em># mv initrd-2.4.20-x.img initrd-2.4.20-x.img.sav</em></span></p><p><span class="emphasis"><em># mkinitrd &#8211;v --preload=BusLogic --omit-lvm-modules initrd-2.4.20-x.img 2.4.20-x</em></span></p><p></p><p>creates a new initial ramdisk. Execute the lilo command once more to be sure.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s04.html">Terug</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ar01s06.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">4. Restoring with start-restore.sh&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top">&nbsp;6. Restoring a single file system with restore-fs.sh</td></tr></table></div></body></html>