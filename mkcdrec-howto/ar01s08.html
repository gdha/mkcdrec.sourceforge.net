<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>8. Other uses of mkCDrec</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="mkCDrec Howto"><link rel="up" href="index.html" title="mkCDrec Howto"><link rel="prev" href="ar01s07.html" title="7. Restoring with HP Openview Storage Data Protector"><link rel="next" href="ar01s09.html" title="9. Know Issues"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">8. Other uses of mkCDrec</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s07.html">Terug</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ar01s09.html">Volgende</a></td></tr></table><hr></div><div class="sect1" lang="nl-NL"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e898"></a>8. Other uses of mkCDrec</h2></div></div></div><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e901"></a>8.1. Restore user-mode Linux (UML)</h3></div></div></div><p>MkCDrec version 0.7.4 and higher is able to restore a mkCDrec backup to a user-mode Linux installation. Ron Yorston experimented with this and basically this was his cookbook:</p><p></p><p><span class="bold"><strong># extract the initrd file from the boot floppy image on the CD</strong></span></p><p><span class="emphasis"><em>mount -t iso9660 /dev/cdrom /mnt/cdrom</em></span></p><p><span class="emphasis"><em>cp /mnt/cdrom/bootflop.img /tmp</em></span></p><p><span class="emphasis"><em>umount /mnt/cdrom</em></span></p><p><span class="emphasis"><em>mount -o loop -t vfat /tmp/bootflop.img /mnt/spare</em></span></p><p><span class="emphasis"><em>cp /mnt/spare/initrd.gz .</em></span></p><p><span class="emphasis"><em>umount /mnt/spare</em></span></p><p><span class="emphasis"><em>gunzip initrd.gz</em></span></p><p></p><p></p><p><span class="bold"><strong># make a 20 Gb disk to restore to</strong></span></p><p><span class="emphasis"><em>dd if=/dev/zero of=mkcdrec_fs bs=1024k count=1 seek=20000</em></span></p><p></p><p><span class="bold"><strong># start UML connected to the 20 Gb disk and the CD drive</strong></span></p><p><span class="emphasis"><em>linux initrd=initrd ubd0=mkcdrec_fs ubd1=/dev/cdrom fakehd fake_ide \</em></span></p><p><span class="emphasis"><em>ubd=3 ramdisk_size=32768 mem=64M devfs=nomount</em></span></p><p></p><p>More on UML can be found on:</p><div class="orderedlist"><ol type="1"><li><p><a href="http://user-mode-linux.sourceforge.net/" target="_top">http://user-mode-linux.sourceforge.net/</a></p></li><li><p><a href="http://linuxhacker.ru/uml/" target="_top">http://linuxhacker.ru/uml/</a></p></li></ol></div></div><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e961"></a>8.2. Superrescue CD-ROM</h3></div></div></div><p>The Superrescue CD-ROM mode will copy the complete /usr from your source Linux system onto the CD-ROM.</p><p>Basically it is quiet easy to make a superrescue CD-ROM with mkCDrec on Intel architecture only. Just do the following:</p><p></p><p><span class="emphasis"><em># make &#8211;f Makefile.x86 superrescue</em></span></p><p></p><p>This way all commands from /usr/bin, /sbin will be available on the CD-ROM.</p><p></p></div><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e976"></a>8.3. MkCDrec Menu (Alt-F5)</h3></div></div></div><p>Once booted from a mkCDrec CD-ROM you will be logged on by default on the /dev/console (also known as Alt-F1). However, there exist a mkCDrec menu to make the life easier of end-users.</p><p></p><p>Therefore type the Alt-F5 key and login as user mkcdrec (with password mkCDrec):</p><p></p><p><img src="resources/mkCDrec_howto_html_6faf2d21.jpg" width="283"></p><p></p><p>You will now see the following menu:</p><p><img src="resources/menu_sh.jpg" width="425"></p><p></p><p>The options are straightforward and need no further explanations.</p><p></p></div><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e996"></a>8.4. One-Button Disaster Recovery</h3></div></div></div><p>OBDR can rapidly restore or replicate a server's operating system, software applications, and data using a tape cartridge(s). This is possible because the tape drive emulates a CD-ROM that allows the server to "boot from tape". This standard feature is embedded in the firmware of HP tape drives.</p><p></p><p>For more information go to <a href="http://www.hp.com/go/obdr" target="_top">http://www.hp.com/go/obdr</a></p><p></p><p>What does this mean? MkCDrec will create an ISO9660 image and put it on a tape instead of burning to a CD-R(W). The backups of the file systems are put after the ISO image. So basically, everything fits on one tape.</p><p></p><p>To boot from tape you need:</p><p></p><div class="orderedlist"><ol type="1"><li><p>a HP tape drive which supports OBDR (see URL above)</p></li><li><p>a PC BIOS able to boot from SCSI (maybe it is needed to put SCSI on top of the list)</p></li><li><p>power-off the PC completely</p></li><li><p>push (while PC is off) on the eject button of the tape drive and switch on the PC. This will activate the OBDR mode and the tape drive will emulate a SCSI CD-ROM. You will notice that the green/orange led&#8217;s intermittent light up.On newer PCs the procedure may be different (F8 instead). See URL above.</p></li><li><p>PC loads the linux and initrd from the tape.</p></li><li><p>tape drive goes out of OBDR mode and become a plain tape drive again.</p></li><li><p>the rd-base.img is read from tape.</p></li><li><p>Linux system is up and running. Restore is possible, see chapter 4.</p></li></ol></div><p></p><p>Simple! How can you make an OBDR tape? There are two ways:</p><p></p><div class="orderedlist"><ol type="1"><li><p>Via the menu option 4 (tape backup) the question will be asked to OBDR or not;</p></li><li><p>Via the command line: <span class="emphasis"><em>make OBDR</em></span></p></li></ol></div></div><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1051"></a>8.5. MkCDrec and PXE Booting</h3></div></div></div><p>Download the document <a href="http://www.ota.be/linux/workshops/20031129/mkCDrec-PXE-notes.zip" target="_top">http://www.ota.be/linux/workshops/20031129/mkCDrec-PXE-notes.zip</a></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s07.html">Terug</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ar01s09.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">7. Restoring with HP Openview Storage Data Protector&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top">&nbsp;9. Know Issues</td></tr></table></div></body></html>