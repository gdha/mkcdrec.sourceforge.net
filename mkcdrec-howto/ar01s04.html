<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>4. Restoring with start-restore.sh</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="mkCDrec Howto"><link rel="up" href="index.html" title="mkCDrec Howto"><link rel="prev" href="ar01s03.html" title="3. Booting from a mkCDrec CD-ROM"><link rel="next" href="ar01s05.html" title="5. Cloning with clone-dsk.sh"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4. Restoring with start-restore.sh</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s03.html">Terug</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ar01s05.html">Volgende</a></td></tr></table><hr></div><div class="sect1" lang="nl-NL"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e501"></a>4. Restoring with start-restore.sh</h2></div></div></div><p>After booting your PC with a mkCDrec CD-ROM you should see a # prompt on your screen. If the archives are not on a CD-ROM make sure the tape is inserted, or the file system has been mounted where original backups were stored on.</p><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e506"></a>4.1. Interactive restore</h3></div></div></div><p></p><p>To restore your system completely from scratch go into directory /etc/recovery and type</p><p></p><p><span class="emphasis"><em># ./start-restore.sh</em></span></p><p></p><p><img src="resources/mkCDrec_howto_html_m77d13a8f.jpg" width="638"></p><p></p><p>If you come across the following warning then mkCDrec was not able to guess your bootloader (lilo, grub, &#8230;). If you are working with the first console, then due to a bug in BusyBox shell it is not possible to type Control-C. To work-around that problem open second console with ALT-F2 and pressing Enter key.</p><p></p><p><img src="resources/mkCDrec_howto_html_5f20e301.jpg" width="567"></p><p></p><p>Find out what the pid is of start-restore.sh shell script and kill it.</p><p></p><p><img src="resources/mkCDrec_howto_html_a5f1502.jpg" width="549"></p><p></p><p>Go back to the first console (ALT-F1) and edit the BOOTLOADER file and replace the UNKNOWN keyword with LILO or GRUB. Thereafter, restart the start-restore.sh shell script again.</p><p></p><p>The restore is quite simple &#8211; just follow the questions.</p><p>Per disk a question will be asked to restore or not.</p><p></p><p><img src="resources/mkCDrec_howto_html_2926cfd8.jpg" width="425"></p><p></p><p>Another question is whether you want to reformat the disk if mkCDrec finds an existing partition table on it.</p><p></p><p><img src="resources/mkCDrec_howto_html_2a10c491.jpg" width="496"></p><p></p><p>The reformat will wipe out the entire disk. There is no way back once done!</p><p></p><p><img src="resources/mkCDrec_howto_html_76bf4c30.jpg" width="602"></p><p></p><p>After reformatting the disk the partitions are ready for creating file systems on it.</p><p></p><p><img src="resources/mkCDrec_howto_html_23ea168c.jpg" width="567"></p><p></p><p>with some file system types, e.g. ReiserFS, a question may be asked.</p><p></p><p><img src="resources/mkCDrec_howto_html_m555051dd.jpg" width="390"></p><p></p><p>Immediately after the creating of a file system on a partition it will get mounted and the restore starts in verbose mode. All the filenames will fly by quite quickly.</p><p></p><p><img src="resources/mkCDrec_howto_html_6bfec16a.jpg" width="248"></p><p></p><p>In case there are multiple CDs involved then you will see a message like the following when mkCDrec needs the next CD in sequence:</p><p><img src="resources/mkCDrec_howto_html_3065d3ad.jpg" width="461"></p><p></p><p>Once a partition has been restored it will get unmounted and a file system check will happen to check the integrity of it.</p><p></p><p><img src="resources/mkCDrec_howto_html_m634f8422.jpg" width="638"></p><p></p><p>At the end when all disks and file systems have been restored mkCDrec will mount the <code class="filename">/</code> and <code class="filename">/boot</code> directory again to run <span class="emphasis"><em>lilo</em></span> or <span class="emphasis"><em>grub</em></span>. This is necessary to make the disk bootable again.</p><p></p><p><img src="resources/mkCDrec_howto_html_f3e612.jpg" width="496"></p><p></p><p>You should see a blue message when the restore went fine. Otherwise, you will see a red banner with some warnings for further inspections.</p><p></p><p>To reboot your system do the following:</p><p></p><p><img src="resources/mkCDrec_howto_html_18ccb72.jpg" width="567"></p><p></p><p>And, finally type, &#8220;<span class="emphasis"><em>reboot</em></span>&#8221; after removing the CD-ROM.</p><p></p><p>If the restore went fine then the disk should be bootable as before&#8230;</p><p></p></div><div class="sect2" lang="nl-NL"><div class="titlepage"><div><div><h3 class="title"><a name="d0e620"></a>4.2. Automatic Disaster Recovery</h3></div></div></div><p>If in <code class="filename">Config.sh</code> the option Automatic Disaster Recovery (AUTODR) was set to &#8220;y&#8221; then when you boot from the mkCDrec CD-ROM the start-restore.sh procedure will be started automatically (after a warning and an interruption possibility of 20 seconds).</p><p></p><p>Of course, when multiple CDs are involved the automatic restore will be interrupted when mkCDrec needs the next CD:</p><p></p><p><img src="resources/mkCDrec_howto_html_3065d3ad.jpg" width="478"></p><p></p><p></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s03.html">Terug</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ar01s05.html">Volgende</a></td></tr><tr><td width="40%" align="left" valign="top">3. Booting from a mkCDrec CD-ROM&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Begin</a></td><td width="40%" align="right" valign="top">&nbsp;5. Cloning with clone-dsk.sh</td></tr></table></div></body></html>